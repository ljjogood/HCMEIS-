# HCMEIS

A PyTorch implementation of Human-like Traditional Chinese Medicine Expert Experience Inheritance System (HCMEIS) for gastrointestinal cancers enhanced by knowledge and school preference double-injection and large language models.

This repository provides a PyTorch implementation of HCMEIS.

### Requirements
The codebase is implemented in Python 3.11.5. package versions used for development are just below.
```
matplotlib        3.9.1
networkx          3.3
numpy             1.24.1
pandas            2.2.2
texttable         1.7.0
torch             2.1.0
torch-cluster     1.6.3
torch-geometric   2.5.3
torch-scatter     2.1.2
torch-sparse      0.6.18
torchvision       0.16.0
tqdm              4.60.0
typing-extensions 4.9.0
argparse          1.4.0
py2neo            2021.2.4
tqdm              4.66.5
```

### Dataset

This TCMGIC dataset is used for model training and contains records of GIC cases treated by TCM physicians between June 2023 and December 2024 from three prospective cohort studies recruiting more than 5,000 patients conducted by Guang'anmen Hospital, China Academy of Chinese Medical Sciences. After excluding 315 records with missing data, a total of 989 records were included to form the TCMGIC dataset.  Among these, there were 445 cases of gastric cancer, 215 cases of esophageal cancer, 158 cases of colon cancer, 143 cases of rectal cancer, and 28 cases of multiple primary digestive system malignancies. 

### Usage
To train the HCMEIS model, the following commands are executed on the TCMGIC training dataset, with evaluation results obtained on the testing dataset. Subsequent steps involve retrieving the graph database, acquiring the drug information of patients similar to the query patient, and computing the IO value of the drugs generated by the model.

Training a HCMEIS model for a 500 epochs with a batch size of 128.
```
python src/train.py --epochs 500 --batch-size 128
```

Testing a HCMEIS model on the TCMGIC testing dataset.
```
python src/test.py 
```

Choosing different school of expert experience.
```
python src/train.py --expert 3
```

Computing the IO value of the drugs generated by the model.
```
python src/get_IO.py
```